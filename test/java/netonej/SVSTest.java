import com.syan.netonej.http.entity.NetoneCertList;
import com.syan.netonej.http.entity.NetoneCertificate;
import com.syan.netonej.http.entity.NetoneSVS;
import com.syan.netonej.http.client.SVSClient;

import java.util.ArrayList;
import java.util.Base64;
import java.util.List;

import com.syan.netonej.exception.*;
public class SVSTest {
	private static String host = "221.226.107.246";
	private static String port = "9188";
	//SM2证书
	//private static String Base64Certificate="MIICFTCCAbygAwIBAgINAJ5cNVwDcxQnBNV6kTAKBggqgRzPVQGDdTBdMQswCQYDVQQGEwJDTjENMAsGA1UECBMEdGVzdDENMAsGA1UEBxMEdGVzdDESMBAGA1UEChMJd2FuZyBsdGQuMQ0wCwYDVQQLEwR0ZXN0MQ0wCwYDVQQDEwR0ZXN0MCIYDzIwMTcxMjE0MTYwMDAwWhgPMjAyNzEyMTIxNjAwMDBaMF0xCzAJBgNVBAYTAkNOMQ0wCwYDVQQIEwR0ZXN0MQ0wCwYDVQQHEwR0ZXN0MRIwEAYDVQQKEwl3YW5nIGx0ZC4xDTALBgNVBAsTBHRlc3QxDTALBgNVBAMTBHRlc3QwWTATBgcqhkjOPQIBBggqgRzPVQGCLQNCAASc76ZNUehNqrVGoYq5nn55KYxaTz2xCSKHhirF+NLdPpCyFEnq6SwpnAeZEwGiyJcUTehqo1xJMvErfJfqG/dKo10wWzAMBgNVHRMEBTADAQH/MB0GA1UdDgQWBBQ1uOOif+xf9Mw3xJd2YlpOPbYO3DAfBgNVHSMEGDAWgBQ1uOOif+xf9Mw3xJd2YlpOPbYO3DALBgNVHQ8EBAMCAYYwCgYIKoEcz1UBg3UDRwAwRAIgHnxwpUSC6mnL4WY/SOIhm6AF9CeqmndXk3CQ9kzWAgUCIHWtq7UIrQGQuMeakMIKjY6PycRW0Pdg0sSBE1SZQLgC";	
	private static String Base64Certificate  = "MIIDjDCCAnSgAwIBAgINAIdhe0Irs07Nmx7ZMTANBgkqhkiG9w0BAQsFADBSMQswCQYDVQQGEwJDTjENMAsGA1UECBMEV0FORzENMAsGA1UEBxMEV0FORzESMBAGA1UEChMJd2FuZyBsdGQuMREwDwYDVQQDEwhob3N0d2FuZzAiGA8yMDE3MDkwOTE2MDAwMFoYDzIwMjcwOTA3MTYwMDAwWjBSMQswCQYDVQQGEwJDTjENMAsGA1UECBMEV0FORzENMAsGA1UEBxMEV0FORzESMBAGA1UEChMJd2FuZyBsdGQuMREwDwYDVQQDEwhob3N0d2FuZzCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALtENBw5NqVPlkWSlbtGiVOPXMPpuEnCogIStlbJi1uUUmrimbjdOOFwEvlTBbkFtloVyf4/V/WvfqtDvgRIMVpVtunWGctkba58982vwCTNPpaOe502CQOh6gO4mN1xN/xwao2hd0QODbK2vnCFKMszSbWNtduq8vUmDnaLTgjVi/dGuTB7hG0WgAVTxLrN+rilun6/LeNWf1OtTr1FK1DP0trOYW0G7dd051Fl29z3z1m7T7feRINckuPNAgrN5UBxxHgSG9lqxhFTJFRlXErsJfqaFvuzxpdOHe+WBpcEfntq9hBZYjrJybuINIzXgLdbmDUVXiK1hbWmbzaCQX8CAwEAAaNdMFswDAYDVR0TBAUwAwEB/zAdBgNVHQ4EFgQUHWmL3vtYdFAAVnJHsbXkiSEzLtgwHwYDVR0jBBgwFoAUHWmL3vtYdFAAVnJHsbXkiSEzLtgwCwYDVR0PBAQDAgGGMA0GCSqGSIb3DQEBCwUAA4IBAQCgCuezac2FlrBvvYWcK0bF+XirO+1uStyXmF+UfsMZObpbvQNh9p9unytHwjBWNA9jerDLEHdMl0Nvdz47Px2OdIWHP3qYckk2ZcuyLVTJstQ1wAchKCStwfIa0/xOkhhqDdzAWUcmAjDzaBT4TjdS02SOEdUIRq36arw5gvqyS2NMmY6wLVjNxqpJq6DYGB8qWGFgH85FkzjX0SdYZm7LSGR0bWvZIjr0klNJws9TQHlqoEQ2E6WbhGfakVbxOhLUkXJTssjHajTEBtPyoggAhDibzHmctfVnXKolEkWwm6bH7sQWPOREj0DOkP9lAJcWBXEA9dnk4B8ueKrcqRZK";
	private static String data = "12344321";
	private static String p1_signature ="WrW5fKNwNTqYKoHFg13TfjRPXZSaMQqH1t2MBa35aSU0V9E42R0s/OOovw2wef1MN7t2gqJd2c+HPMmj7ks4ByEC6QmA02grVPTnbJHVagVoiQ0LzVT4dGdlnkqkk3YMcPaOFFcKgJ0bARvtkCApQhgsfWXtxGemKHzl9goiFC4SzaumNWbEwNjjLQL1cpgF5aOtM/LesIFQNgL0dCZrPQGpaoXZYy6Vrp0mQgj2y4jAciMpTKoCJ3FkiFWzijV9vSBZ77I+BvdBeGKwlSPAuEVQM+aeRIb8bx+1TF2SGJ+55qPJFLRVOH7YlT8VcGt7x4wT2NVZwKAJx0D/fo3zIA==";
	//SM2-P1签名
	//private static String p1_signature ="MEUCIQCY88ZljUhQxESMX3YqlYhxy1kijUB/Uo6aEQh3ZxmD3wIgGD3HftdNVx0tz3Xbg5Eyuc08xLHiRKdj+1r/32pV230";
	private static String p7_signature = "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";
	private static String p7_signatureattached="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";
	private final String signxml="PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxwY3M+PHZlcnNpb24+MS41LjQ8L3ZlcnNpb24+PGFjdGlvbj5lbnZzZWFsPC9hY3Rpb24+PGtpZD44YmMzYjk4MjE3N2NiOTJkOGUxMTlkZjQ4YjQyYjJmYTwva2lkPjxpZD45NjUwNTU1MjU3NDA1MzU5MzY4PC9pZD48aWRtYWdpYz5zbmRlYzwvaWRtYWdpYz48Y2lwaGVyPkFFUy0yNTYtQ0JDPC9jaXBoZXI+PGRhdGE+TUlJRjV3WUpLb1pJaHZjTkFRY0VvSUlGMkRDQ0JkUUNBUUV4Z2dFQU1JSDlBZ0VBTUdZd1dURUxNQWtHQTFVRUJoTUNRMDR4RlRBVEJnTlZCQW9VRE9XRmlPV3VpZWVua2VhS2dERVFNQTRHQTFVRUF4TUhSMEZVUlZkQldURWhNQjhHQTFVRUN4TVlNVEV6TnpBek5qSTVPVlUwTTBNMVEwTXdRa0l4TlRVMUFna0FoZTJvNERMc3hRZ3dEUVlKS29aSWh2Y05BUUVCQlFBRWdZQlA3WFE3bFR4Yk94dlYyRzU2dDRyMHZ3QXhqNlV0ZStSdWw5UmdOU0tjMmVWSW9WRGpuSWUyUFl5SE9PS1RJVnVCeGZuTVRWRHovMEpUTHgvWVVJd1JNTVNMNldBVUwxVjZra3hmM3VWWDVkMUtSZGFxSUhESVFrbmtjMmtWTC9iSEJYMkRIRnVNMHo4b2ZGdDdQRi9QODVlVC9XZnF3TVF5R1pGUUEyWkxyakVMTUFrR0JTc09Bd0lhQlFBd1RBWUpLb1pJaHZjTkFRY0JNQjBHQ1dDR1NBRmxBd1FCS2dRUXZFTkNYMFhSa2h1b2g3MUp4bytRNm9BZ0hNVTA5b3NxcEI4Uis2enh2Y2dtdWN0RzBoazdhQkljZDZrQVd4TTVNUDJnZ2dOZU1JSURXakNDQXNPZ0F3SUJBZ0lKQUlYdHFPQXk3TVVJTUEwR0NTcUdTSWIzRFFFQkJBVUFNRmt4Q3pBSkJnTlZCQVlUQWtOT01SVXdFd1lEVlFRS0ZBemxoWWpscm9ubnA1SG1pb0F4RURBT0JnTlZCQU1UQjBkQlZFVlhRVmt4SVRBZkJnTlZCQXNUR0RFeE16Y3dNell5T1RsVk5ETkROVU5ETUVKQ01UVTFOVEFlRncweE1ERXhNekF4TmpBd01EQmFGdzB5TURFeE16QXhOakF3TURCYU1JR1dNUXN3Q1FZRFZRUUdFd0pEVGpFYk1Ca0dBMVVFQnhRUzVyR2Y2SXVQNTV5QjVZMlg1THFzNWJpQ01SVXdFd1lEVlFRS0ZBemxoWWpscm9ubnA1SG1pb0F4RlRBVEJnTlZCQXNVRE9hS2dPYWNyK2FVcithTWdURVpNQmNHQTFVRUF4TVFaR1Z0Ynk1emVXRnVMbU52YlM1amJqRWhNQjhHQTFVRUxSTVlNVEk1TXpBd05qRXhPRlUwUkRFeFFqVXlOamxDTVVNeE1JR2ZNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0R05BRENCaVFLQmdRQ3NCK1VOeDM2djJFdHl0TTdvVC9ULzFkNlpibW5KQTdzODlDNHdHaEJML3hJSEM4Q0pwZG9RVTZRNGMySzBCY3gzYnNrWnJ0L01UUFhOYXp3cHJmRXl0YjdzZ1YyeVkrdGxZenFSUkUrblZjaWtaVjBxanozRWQyeXh3L282RXU5U0daNnJTTmlFd2VyaDBYeFdyM1FDUDFGQUUyMkJ5U05namxlcFlJelE4UUlEQVFBQm80SHJNSUhvTUFrR0ExVWRFd1FDTUFBd0lRWUpZSVpJQVliNFFnRU5CQlFXRWs1RlZFOU9SU0JqWlhKMGFXWnBZMkYwWlRBZEJnTlZIUTRFRmdRVVpURFl5VGlXVmthZ2ZwWVUrREhjSkFodmxySXdnWXNHQTFVZEl3U0JnekNCZ0lBVU9ibis0OVBGZ0dtY2ZRSTNMengvbjc2TTZrK2hYYVJiTUZreEN6QUpCZ05WQkFZVEFrTk9NUlV3RXdZRFZRUUtGQXpsaFlqbHJvbm5wNUhtaW9BeEVEQU9CZ05WQkFNVEIwZEJWRVZYUVZreElUQWZCZ05WQkFzVEdERXhNemN3TXpZeU9UbFZORE5ETlVORE1FSkNNVFUxTllJSkFJNE5LRjIxbFdIbk1Bc0dBMVVkRHdRRUF3SUY0REFOQmdrcWhraUc5dzBCQVFRRkFBT0JnUURVMjNjUmtEdGZnZTdHUG1JclJFZnNGZk5RWFJwYi9jMEx6UDgwQ2xnem4wOGlLMkQyY2ZRaEwrSmx1RnYvSW1odXZhYmRhQ1ZSdmdNQ2JIS1ozRE1VVlcwTmNaSmpzSkpMLzZOd2xmTWNJUnRQMHlkek9LdkRHdVRaUnNyVlBUV2IveUZSVXlaQjc0WGFKRVdUNnJvMm5oWDhoZSs3cit3S1J6QklvNy9yeVRHQ0FRd3dnZ0VJQWdFQk1HWXdXVEVMTUFrR0ExVUVCaE1DUTA0eEZUQVRCZ05WQkFvVURPV0ZpT1d1aWVlbmtlYUtnREVRTUE0R0ExVUVBeE1IUjBGVVJWZEJXVEVoTUI4R0ExVUVDeE1ZTVRFek56QXpOakk1T1ZVME0wTTFRME13UWtJeE5UVTFBZ2tBaGUybzRETHN4UWd3Q1FZRkt3NERBaG9GQURBTkJna3Foa2lHOXcwQkFRRUZBQVNCZ0kxdXpITWhkbEo5QmQzekJ3UVVsZW4xRGlIMnAxWlVWUVVtMk1xTVE0UzduZE5FaHJTZG5CVG9GQWZ3ODVmanJZaDkzNFJzcHhJYnRIMDZNU3IwTUFhTW5TQmJiM3B2Z3F3Wk55cWYyOGZCQnJXRmI0eTEwZ1pLcUMzb29nUVk4cTMzekVUTE9LOWFmSG5UWDM3d0JhY21pSnpBdHlJd3BjWC90SmZ1WGg4aTwvZGF0YT48U2lnbmF0dXJlIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIj4KPFNpZ25lZEluZm8+CjxDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8+CjxTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2Ii8+CjxSZWZlcmVuY2U+CjxUcmFuc2Zvcm1zPgo8VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiLz4KPC9UcmFuc2Zvcm1zPgo8RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjc2hhMjU2Ii8+CjxEaWdlc3RWYWx1ZT5admN5K0tvOGVXcVVIK2hpR3ZtUW1LSDEvWi8wSktsaUgzaW5qcGF3ZTVZPTwvRGlnZXN0VmFsdWU+CjwvUmVmZXJlbmNlPgo8L1NpZ25lZEluZm8+CjxTaWduYXR1cmVWYWx1ZT5FL2NBTzNkRmRwbGRGT1N6N0p3N2pFTmNGR0s5VEE0amFPeDBYNHE5eE9EaFRrdmNVTkcvYnh6ci8vdjBFaU5sCmxQc2lmeHBNRDdzRVVacm4wMUc1UkJEblQ2RHk4NjdhS0c0KzZZRkJoV0RrUTAyejBDWDRHRWZnTGYvN2hqczkKYzlRODJTc3U0VUZxQUdjZFp4YlpzWk10ekFVdlhtd3piQnZHZU0wQ2U4QzFaK2RJdTRLd1JTMmN2MXh2dG5iZQpoS1lQa1k3WEFEeC9DWTVreEV1aGt3eDkvZFFRSjJZc0dOOWFUWVZnaGdKa1NhM0lvVDVSN0ladHc5SFd0Wjd3CnJJcTRlOHJYeUJOcDI2anRvR0g3eEpVa3Fsd2NPYkFaVXlzZ2hDSW1MaU94bDM5T1hQMUR2dEZFclVtNnVoQVIKQjVBamZxSU1EenNPYW53Vm9LTlBqZz09PC9TaWduYXR1cmVWYWx1ZT4KPEtleUluZm8+CjxYNTA5RGF0YT4KPFg1MDlDZXJ0aWZpY2F0ZT5NSUlEakRDQ0FuU2dBd0lCQWdJTkFJZGhlMElyczA3Tm14N1pNVEFOQmdrcWhraUc5dzBCQVFzRkFEQlNNUXN3CkNRWURWUVFHRXdKRFRqRU5NQXNHQTFVRUNCTUVWMEZPUnpFTk1Bc0dBMVVFQnhNRVYwRk9SekVTTUJBR0ExVUUKQ2hNSmQyRnVaeUJzZEdRdU1SRXdEd1lEVlFRREV3aG9iM04wZDJGdVp6QWlHQTh5TURFM01Ea3dPVEUyTURBdwpNRm9ZRHpJd01qY3dPVEEzTVRZd01EQXdXakJTTVFzd0NRWURWUVFHRXdKRFRqRU5NQXNHQTFVRUNCTUVWMEZPClJ6RU5NQXNHQTFVRUJ4TUVWMEZPUnpFU01CQUdBMVVFQ2hNSmQyRnVaeUJzZEdRdU1SRXdEd1lEVlFRREV3aG8KYjNOMGQyRnVaekNDQVNJd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFMdEVOQnc1TnFWUApsa1dTbGJ0R2lWT1BYTVBwdUVuQ29nSVN0bGJKaTF1VVVtcmltYmpkT09Gd0V2bFRCYmtGdGxvVnlmNC9WL1d2CmZxdER2Z1JJTVZwVnR1bldHY3RrYmE1ODk4MnZ3Q1ROUHBhT2U1MDJDUU9oNmdPNG1OMXhOL3h3YW8yaGQwUU8KRGJLMnZuQ0ZLTXN6U2JXTnRkdXE4dlVtRG5hTFRnalZpL2RHdVRCN2hHMFdnQVZUeExyTityaWx1bjYvTGVOVwpmMU90VHIxRksxRFAwdHJPWVcwRzdkZDA1MUZsMjl6M3oxbTdUN2ZlUklOY2t1UE5BZ3JONVVCeHhIZ1NHOWxxCnhoRlRKRlJsWEVyc0pmcWFGdnV6eHBkT0hlK1dCcGNFZm50cTloQlpZanJKeWJ1SU5JelhnTGRibURVVlhpSzEKaGJXbWJ6YUNRWDhDQXdFQUFhTmRNRnN3REFZRFZSMFRCQVV3QXdFQi96QWRCZ05WSFE0RUZnUVVIV21MM3Z0WQpkRkFBVm5KSHNiWGtpU0V6THRnd0h3WURWUjBqQkJnd0ZvQVVIV21MM3Z0WWRGQUFWbkpIc2JYa2lTRXpMdGd3CkN3WURWUjBQQkFRREFnR0dNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUNnQ3VlemFjMkZsckJ2dllXY0swYkYKK1hpck8rMXVTdHlYbUYrVWZzTVpPYnBidlFOaDlwOXVueXRId2pCV05BOWplckRMRUhkTWwwTnZkejQ3UHgyTwpkSVdIUDNxWWNrazJaY3V5TFZUSnN0UTF3QWNoS0NTdHdmSWEwL3hPa2hocURkekFXVWNtQWpEemFCVDRUamRTCjAyU09FZFVJUnEzNmFydzVndnF5UzJOTW1ZNndMVmpOeHFwSnE2RFlHQjhxV0dGZ0g4NUZrempYMFNkWVptN0wKU0dSMGJXdlpJanIwa2xOSndzOVRRSGxxb0VRMkU2V2JoR2Zha1ZieE9oTFVrWEpUc3NqSGFqVEVCdFB5b2dnQQpoRGliekhtY3RmVm5YS29sRWtXd202Ykg3c1FXUE9SRWowRE9rUDlsQUpjV0JYRUE5ZG5rNEI4dWVLcmNxUlpLPC9YNTA5Q2VydGlmaWNhdGU+CjwvWDUwOURhdGE+CjwvS2V5SW5mbz4KPC9TaWduYXR1cmU+PC9wY3M+Cg==";
	private static SVSClient svs=new SVSClient(host, port);
	
	//枚举服务端证书列表
	public void testlistcerts() throws NetonejExcepption{
		NetoneCertList certList=svs.listCertificates();	
		List<NetoneCertificate> list=new ArrayList<NetoneCertificate>();
		list=certList.getCertList();
		for(int i=0;i<list.size();i++){
			System.out.println(list.get(i).getDecSerial());
			System.out.println(list.get(i).getSubject());
		}
		
		
	}
	
	//验证数字证书
	public void testVerifyCertificate() {
		try {
			svs.enabledGreenpass();
			String base64cert="MIIEDTCCAvWgAwIBAgIIIBgFJABDgCgwDQYJKoZIhvcNAQEFBQAwgZkxFTATBgNVBAMMDEpTQ0FfQ0FfVEVTVDENMAsGA1UECwwESlNDQTE8MDoGA1UECgwz5rGf6IuP55yB55S15a2Q5ZWG5Yqh5pyN5Yqh5Lit5b+D5pyJ6ZmQ6LSj5Lu75YWs5Y+4MRIwEAYDVQQHDAnljZfkuqzluIIxEjAQBgNVBAgMCeaxn+iLj+ecgTELMAkGA1UEBhMCQ04wHhcNMTEwNjIxMTYwMDAwWhcNMTIwNjIxMTYwMDAwWjCB4DEOMAwGA1UEWAwFMDAwMDExEjAQBgNVBBoMCeW4gui+luWMujERMA8GA1UELQwIZW50Q2VydDIxCzAJBgNVBAYTAkNOMRIwEAYDVQQIDAnmsZ/oi4/nnIExEjAQBgNVBAcMCeWNl+S6rOW4gjEkMCIGA1UECgwbcXHooYzliqnmiYvmtYvor5UyMDE4MDQxODAyMQwwCgYDVQQLDAMwMTYxGDAWBgNVBCoMDzMyMDEwMDEwMDA1OTkxMDEkMCIGA1UEAwwbcXHooYzliqnmiYvmtYvor5UyMDE4MDQxODAyMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCfD4RIQLGPU898UAflHtQyk3HsYSvgiZoXFO1H7xK4xvMmDnYeZJfaWzjHFMU4IG+UCL07K9izWG9KWjbHRQSorI5HGOqfScfFxaCgg6FnZCUKejpfSa/an2vD5feu1Geqhq1KVSg31QhTGMsH5gWR02vhXwcctPKtfOl4m5DatwIDAQABo4GTMIGQMAsGA1UdDwQEAwIGwDAdBgNVHQ4EFgQUxKp7VadEbBTfY+gIVjzhSrzGScUwHwYDVR0jBBgwFoAU4NqI9JYLx4Y8obZEgXDYcSBi9K0wQQYDVR0fBDowODA2oDSgMoYwaHR0cDovLzEwLjY3LjEuMjAzL2hvbWUvY3JsLzIwMTdjcmxfcnNhX3RpbWUuY3JsMA0GCSqGSIb3DQEBBQUAA4IBAQBjvbeCQICOgTXThGqG4vxlcHY/21OO6xsubwgvCllWiEBnXiMW7+YG0Ih4DxZQchdQicPq10uX6jglUu0nVqH4PqRbfgSYjinTBpxf0JbMH5wAIAoB7Fo8YryQXBD2udeqytzPYm5JxSzd7BWd/3+8xmeem+GdVIgSGGjZdX4eY7SvxQwD8WdsAxghEm+TKyBSCqt9NBt7Pqtfgz52K2GyseGvFjHDlPLcNXEEEa+drRCl6dsMsKLS9cKuzy1IobndnoHISNw0NVM/cAwBXhjT/7zEo9SS0OSii2UsFpiXBEt7+zx9Q5TrVUOxQ9YK27uzDR5XWSBt21IuFIWfPtL3";
			NetoneSVS result = svs.verifyCertificate(base64cert);
			System.out.println("SVS证书有效性验证结果："+result.getStatusCode());
			if(result.getStatusCode()==200){
			System.out.println("证书验证通过");
			NetoneCertificate certificate=result.getCertificate();
			System.out.println("证书序列号（16进制）:"+certificate.getHexSerial());
			System.out.println("证书主题项:"+certificate.getSubject());
			}
		} catch (NetonejExcepption e) {
			System.out.println("异常错误信息是："+e.toString());
		}
	}
	//验证P1签名
	public void testVerifyPKCS1String() {
		try {
			String data2="签名原文";
			byte[] data3=data2.getBytes();
			String data1=Base64.getEncoder().encodeToString(data3);
			String data5=new String(Base64.getDecoder().decode(data1));
			System.out.println(data1);
			System.out.println(data5);
			String p1sign="MEUCIQCiTeRq7SKFyEPJaOBUOLYXRTVRhGrVqxCc6c6F+BG5UQIgVQFVthBSN7xlXFGArxLa2J4ivO4BMoSJlB1pvpTBjPc=";
			String cert1="MIICzzCCAnOgAwIBAgIQGi5fQpqg1SbmOUtP3iis6DAMBggqgRzPVQGDdQUAMHgxCzAJBgNVBAYTAkNOMRIwEAYDVQQIDAlDaG9uZ3FpbmcxOjA4BgNVBAoMMUVhc3QtWmhvbmd4dW4gQ2VydGlmaWNhdGUgQXV0aG9yaXR5IENlbnRlciBDTy5MVEQxGTAXBgNVBAMMEEVhc3QtWmhvbmd4dW4gQ0EwHhcNMTgwNzA4MDIzMzU1WhcNMTkwNzA4MDIzMzU1WjBCMQswCQYDVQQGEwJDTjEOMAwGA1UECxMFVEVTVC4xIzAhBgNVBAMMGnRlc3TmtYvor5Xor4HkuaYyMDE4MDcwOTA0MFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAESAGz0K1BnyQG9tNDdj68QVbOie3/A+WkmHpmxm1dxp3924acW8DimR5ZArEajuLl+1NImSbW+YUMXJsdavwSqaOCAREwggENMB8GA1UdIwQYMBaAFCmeS3cfuGGqNBPUp7m0IdHp72XzMAkGA1UdEwQCMAAwgbIGA1UdHwSBqjCBpzAuoCygKoYoaHR0cDovL3d3dy5lemNhLm9yZy9jcmwvY3JsLmNybC9jcmwzLmNybDB1oHOgcYZvbGRhcDovL2xkYXAuZXpjYS5vcmc6Mzg5L0NOPWNybDMsT1U9RXh0Q1JMLEM9Q04/Y2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdD9iYXNlP29iamVjdGNsYXNzPWNSTERpc3RyaWJ1dGlvblBvaW50MAsGA1UdDwQEAwIGwDAdBgNVHQ4EFgQULTL3uX9I3QVgq1W02tLp8i5CNe4wDAYIKoEcz1UBg3UFAANIADBFAiEArI72N/EsJR4mn+wvRG4gfiSQpcBLOG4kBlQtb6lb7mICIHVwZERN3KF6bwJULTXm7QiCXKLs1axJM/2r6CgiIUa2";
			//NetoneSVS	result = svs.verifyPKCS1(data, p1_signature,"RSA-SHA1", "0", Base64Certificate,false);
			NetoneSVS	result = svs.verifyPKCS1(data1, p1sign,"ecdsa-sm2-with-sm3", "0", cert1,true);
			//NetoneSVS result=svs.verifyPKCS1(data,p1_signature,Base64Certificate,false);
			if(result.getStatusCode()==200){
				System.out.println("SVS PKCS#1签名验证结果："+result.getStatusCode());
				System.out.println("P1签名验证通过");
				System.out.println("签名原文(Base64编码):"+result.getOrginalBase64());
				NetoneCertificate certificate=result.getCertificate();
				System.out.println("签名证书序列号（16进制）:"+certificate.getHexSerial());
				System.out.println("签名证书主题项:"+certificate.getSubject());
			}else {
				System.out.println("P1签名验证失败"+result.getStatusCode()+" "+result.getStatusCodeMessage());
			}
		} catch (Exception e) {
			System.out.println("异常错误信息是："+e.toString());
			//fail("NetonejExcepption");
		}
	}
	//验证P7签名（attached）
	public void testVerifyPKCS7attachString() {
		try {
			NetoneSVS	result = svs.verifyPKCS7(p7_signatureattached);
			if(result.getStatusCode()==200){
				System.out.println("SVS PKCS#7签名验证结果："+result.getStatusCode());
				System.out.println("P7(attached)签名验证通过");
				System.out.println("签名原文(Base64编码):"+result.getOrginalBase64());
				NetoneCertificate certificate=result.getCertificate();
				System.out.println("签名证书序列号（16进制）:"+certificate.getHexSerial());
				System.out.println("签名证书主题项:"+certificate.getSubject());
			}else {
				System.out.println("P7(attached)签名验证失败"+result.getStatusCode()+" "+result.getStatusCodeMessage());
			}
		} catch (Exception e) {
			System.out.println("异常错误信息是："+e.toString());
		}
	}
	//验证P7（detached）签名
	public void testVerifyPKCS7detachString() {
		try {
			NetoneSVS result = svs.verifyPKCS7(p7_signature, data, false);
			if(result.getStatusCode()==200){
				System.out.println("SVS PKCS#7签名验证结果："+result.getStatusCode());
				System.out.println("P7(detached)签名验证通过");
				System.out.println("签名原文(Base64编码):"+result.getOrginalBase64());
				NetoneCertificate certificate=result.getCertificate();
				System.out.println("签名证书序列号（16进制）:"+certificate.getHexSerial());
				System.out.println("签名证书主题项:"+certificate.getSubject());
			}else {
				System.out.println("P7(detached)签名验证失败"+result.getStatusCode()+" "+result.getStatusCodeMessage());
			}
		} catch (Exception e) {
			System.out.println("异常错误信息是："+e.toString());
			//fail("NetonejExcepption");
		}
	}
	//验证XML签名
	public void testVerifyXML() {
		try {
			NetoneSVS result = svs.verifyXML(signxml);
			System.out.println("SVS XML签名验证结果："+result.getStatusCode() +"  "+result.getCertificate().getSubject());
			if(result.getStatusCode()==200){				
				System.out.println("XML签名验证通过");
				System.out.println("签名原文(Base64编码):"+result.getOrginalBase64());
				NetoneCertificate certificate=result.getCertificate();
				System.out.println("签名证书序列号（16进制）:"+certificate.getHexSerial());
				System.out.println("签名证书主题项:"+certificate.getSubject());
			}
		} catch (Exception e) {
			System.out.println("异常错误信息是："+e.toString());
			//fail("NetonejExcepption");
		}
	}

}
